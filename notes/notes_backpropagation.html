<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Burak Ç. Personal Website</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css">
    <link href="https://fonts.googleapis.com/css?family=Oswald&display=swap" rel="stylesheet">

    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            processEscapes: true
          }
        });
      </script>

    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
</head>

<body style="font-family: 'Oswald', sans-serif;">



    <section class="hero is-link is-medium">
        <div class="hero-head">
            <nav class="navbar">
                <div class="container">
                    <div class="navbar-brand">
                        <a href="../index.html" class="navbar-item">
                            <p class="title is-1" style="font-family: 'Oswald', sans-serif;
                    ">Burak</p>
                        </a>
                        <span class="navbar-burger burger" data-target="navbarMenuHeroB">
                            <span></span>
                            <span></span>
                            <span></span>
                        </span>
                    </div>
                    <div id="navbarMenuHeroB" class="navbar-menu">
                        <div class="navbar-end">
                            <a href="../index.html" class="navbar-item">
                                    <i class="fas fa-home"></i>
                            </a>
                            <a href="../projects.html" class="navbar-item">
                                Projects
                            </a>
                            <a href="../notes.html" class="navbar-item is-active">
                                Notes
                            </a>

                        </div>

                        <div class="navbar-end">
                            <div class="navbar-item">
                                <div class="buttons">
                                    <a href="https://github.com/bcivitcioglu" target="_blank" class="button is-primary">
                                        <i class="fab fa-github"></i>
                                    </a>
                                    <a href="https://www.linkedin.com/in/burakcivitcioglu/" target="_blank"
                                        class="button is-info">
                                        <i class="fab fa-linkedin"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
            <script type="text/javascript">
                (function() {
                  var burger = document.querySelector('.burger');
                  var nav = document.querySelector('#'+burger.dataset.target);
                  burger.addEventListener('click', function(){
                    burger.classList.toggle('is-active');
                    nav.classList.toggle('is-active');
                  });
                })();
              </script>
        </div>

        <div class="hero-body">

            <div class="container has-text-centered">
                <p class="title">
                        Backpropagation
                </p>
                
            </div>

        </div>


    </section>

    <br>
    <nav class="breadcrumb is-centered" aria-label="breadcrumbs">
        <ul>
            <li><a href="../notes.html">Notes</a></li>
            <li class="is-active"><a href="../notes/notes_backpropagation.html" aria-current="page">
                    Backpropagation</a></li>
        </ul>
    </nav>
    <div class="columns">
        <div class="column is-narrow">
            <div style="width: 200px;">
                <p class="title is-5"></p>
            </div>
        </div>

        <div class="column">
            <div class="box" style="text-align: justify; text-justify: inter-word;">
                <p class="title is-3">Back Propagation</p>
<p>At this point we have already formulized the cost function. Now we need to calculate the cost function and its derivatives. We need to compute now:
    $$ J(\theta), \frac{\partial}{\partial \theta_{ij}^{(l)}}$$
Assume that we only have one training example 
    $$ (x,y)$$</p>

<p class="title is-5">Forward Propagation</p>
<p>$$ a^{(1)} = x$$
   $$ z^{(2)} = \theta^{(1)} a^{(1)} $$
   $$ a^{(2)} = \sigma(z^{(2)}), \text{ add } a_0^{(2)}$$
   $$ z^{(3)} = \theta^{(2)} a^{(2)}$$
   $$ a^{(3)} = \sigma(z^{(3)}) \text{ add } a_0^{(3)}$$
   $$ z^{(4)} = \theta^{(3)} a^{(3)}$$
   $$ a^{(4)} = \sigma(z^{(4)}) = h(x) = \text{ the hypothesis }$$
   
   </p><img src="../images/image_backpropagation_vertical.png"
                    style="  display: block; margin-left: auto; margin-right: auto; width: 50%;">
<p class="title is-5">Back Propagation</p>
<p>At each time we do a forward propagation where we calculate $$a^{(l)}$$ we also calculate 
$$ \delta^{(l)}$$ which is named as the error of nodes in layer l. But this time, we have to 
propagate backwards. We will start with the last one and then calculate the error of previous layers.
    $$ \delta^{(4)} = a^{(4)} - y$$
    $$ \delta^{(3)} = (\theta^{(3)})^T \delta^{(4)} \odot g'(z^{(3)})$$
    $$ \delta^{(2)} = (\theta^{(2)})^T \delta^{(3)} \odot g'(z^{(2)})$$ The multiplication symbol is called the Hadamard Product and it basically means that we multiple the matrices element by element. We do not have any error in the first layer since it is the input layer. Without regularization, we have 
    $$ \frac{\partial}{\partial \theta_{ij}^{(l)}} J(\theta) = a_j^{(l)} \delta_i^{(l+1)}$$</p>
<p class="title is-5">Back Propagation Algorithm</p>
<p>We have the training set 
    $$ t = \{(x^{(1)},y^{(1)}),\dots,(x^{(m)},y^{(m)})\}$$ We set initially;
    $$ \Delta_{ij}^{(l)} = 0$$ for all indices. Then we will do for all training set, (usually with a for loop), the following set of operations, in order. 
    $$ a^{(1)} = x^{(i)}$$
    $$ \text{FP and compute for all l } a^{(l)}$$
    $$ \text{compute all } \delta^{(l)}$$
    $$ \Delta_{ij}^{(l)} = \Delta_{ij}^{(l)} + a_j^{(l)} \delta_i^{(l+1)}$$ Now we have the necessary values to calculate finally the derivatives all at once. Finally we have,
    $$ D_{ij}^{(l)} = \frac{1}{m} \Delta_{ij}^{(l)} + \lambda \theta_{ij}^{l}$$ for non zero j values. For zero j value, 
    $$ D_{ij}^{(l)} = \frac{1}{m} \Delta_{ij}^{(l)}$$ These are the derivatives of the cost function. Now finally we have achieved to have both the cost function and all the necessary derivatives. After this point we will apply gradient descent and get the optimized hypothesis.</p>
<p class="title is-5">Dimensional Remarks</p>
<p>Let us have an architecture so that we have 10 nodes in the input layer, 1 hidden layer with 10 nodes and one output layer with 1 node. Then the dimensions will be:
    $$ d(\theta^{(1)}) = d(\theta^{(2)})= d(D^{(1)}) =10 \times 11$$
    $$ d(\theta^{(3)}) = 1 \times 11$$</p>
    
<p class="title is-5">Gradient Checking</p>
<p>For only one value of our parameters, we can check if we are on the right track. What we can do is to see if the below expression
    $$ \frac{d J}{d \theta} \approx \frac{J(\theta + \epsilon) - J(\theta - \epsilon)}{2\epsilon}$$ is close to our
    result from backpropagation. This is a basic calculus definition of a derivative in the limit. In our case we need $$ \epsilon \approx 10^{-4}$$ This can be used for debugging and checking if we are on the right track. 
</p>
<br>
<p class="title is-5">Initialize the weights randomly in a small interval.</p>
<p>This will help broke the possible symmetry that may cause a repetition.</p>
<br>
<p class="title is-4">Training a Neural Network</p>
<p><div class="content">
  <ol type="1">
    <li>Design a neural network architecture. Conventionally, all the hidden layers have the same number of nodes.</li>
    <li>Randomly initialize the weights.</li>
    <li>Implement forward propagation.</li>
    <li>Compute the cost function.</li>
    <li>Implement back propagation.</li>
    <li>Get the derivatives of the cost function.</li>
    <li>Apply gradient checking.</li>
    <li>Apply gradient descent with respect to the weights.</li>
  </ol>
</div></p>

        </div>
    </div>


    <div class="column is-narrow">
        <div style="width: 200px;">
            <p class="title is-5"></p>
        </div>
    </div>

    </div>
        <div class="columns">
            <div class="column is-narrow">
                <div style="width: 200px;">
                    <p class="title is-5"></p>
                </div>
            </div>

            <div class="column">
                <div class="box has-text-centered" style="text-align: justify; text-justify: inter-word;">
                    <a href="#" target="_blank"><button
                            class="button is-link is-light is-outlined">python implementation</button></a>

                    </p>
                </div>
            </div>

            <div class="column is-narrow">
                <div style="width: 200px;">
                    <p class="title is-5"></p>
                </div>
            </div>
        </div>
    
</body>

<footer class="footer">
    <div class="content has-text-centered">
        <p>
            <strong>Burak Çivitcioğlu's personal website.
        </p>
        <a href="https://github.com/bcivitcioglu" target="_blank" class="button is-primary">
            <i class="fab fa-github"></i>
          </a>
          <a href="https://www.linkedin.com/in/burakcivitcioglu/" target="_blank" class="button is-info">
            <i class="fab fa-linkedin"></i>
          </a>
    </div>
</footer>

</html>